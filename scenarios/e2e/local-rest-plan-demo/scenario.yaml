---
id: "local-rest-plan-demo"
name: "Local REST Plan Demo"
description: "Local REST swarm that uses a scenario plan to drive the entire lifecycle:\
  \ start all workers, change generator rate, stop and restart the generator, then\
  \ stop the swarm without issuing an explicit swarm-start command.\n"
template:
  image: "swarm-controller:latest"
  bees:
  - role: "generator"
    image: "generator:latest"
    work:
      in:
        in: null
      out:
        out: "genQ"
    env: {}
    config:
      inputs:
        scheduler:
          ratePerSec: 10
      worker:
        message:
          bodyType: "HTTP"
          path: "/test"
          method: "POST"
          body: "{\"event\":\"local-rest-plan-demo\"}"
          headers:
            content-type: "application/json"
  - role: "processor"
    image: "processor:latest"
    work:
      in:
        in: "genQ"
      out:
        out: "finalQ"
    env: {}
    config:
      worker:
        baseUrl: "{{ sut.endpoints['default'].baseUrl }}/api"
  - role: "postprocessor"
    image: "postprocessor:latest"
    work:
      in:
        in: "finalQ"
      out:
        out: null
    env: {}
trafficPolicy: null
plan:
  bees:
  - role: "generator"
    steps:
    - stepId: "gen-rate-fast"
      name: "Increase generator rate to 50/s"
      time: "PT5S"
      type: "config-update"
      config:
        inputs:
          scheduler:
            ratePerSec: 50
    - stepId: "gen-stop-1"
      name: "Stop generator"
      time: "PT15S"
      type: "stop"
    - stepId: "gen-start-2"
      name: "Restart generator"
      time: "PT35S"
      type: "start"
  swarm:
  - stepId: "swarm-start"
    name: "Enable swarm workloads"
    time: "PT1S"
    type: "start"
  - stepId: "swarm-stop"
    name: "Stop swarm workloads"
    time: "PT40S"
    type: "stop"
